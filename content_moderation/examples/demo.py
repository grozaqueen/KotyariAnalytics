from content_moderation.moderator import ModerationPipeline


def pretty(res: dict, sample: str):
    print(f"=> decision: {res['decision']} | reason: {res['reason']}")

    if res.get("hits"):
        print("   dict hits:")
        for k, vals in res["hits"].items():
            print(f"     - {k}: {', '.join(vals)}")
    else:
        print("   dict hits: (none)")

    if res.get("scores"):
        print("   ml scores:")
        for k, v in sorted(res["scores"].items(), key=lambda x: -x[1]):
            print(f"     - {k}: {v:.3f}")
    else:
        print("   ml scores: (none)")

    if res["text"] is None:
        print("   text: <BLOCKED>")
    elif res["text"] != sample:
        print(f"   redacted text: {res['text']}")


if __name__ == "__main__":
    pipe = ModerationPipeline()

    samples = [
        "–°—É–∫–∞!",
        "–ù—É —Ç—ã –∏ —Ö—É–π.",
        "–ë–ª—è–¥—å, –æ–ø—è—Ç—å –æ–ø–æ–∑–¥–∞–ª!",
        "–ü–∏–¥–æ—Ä —Å–∏–¥–∏—Ç –≤ —É–≥–ª—É.",
        "–ï–±–∞—Ç—å, –≤–æ—Ç —ç—Ç–æ –ø–æ–≤–æ—Ä–æ—Ç.",

        "–≠—Ç–∏ —Å—É–∫–∏ –æ–ø—è—Ç—å –≤—Å—ë –∏—Å–ø–æ—Ä—Ç–∏–ª–∏.",
        "–û–Ω —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç –∫–∞–∫ –ø–∏–¥–æ—Ä—ã.",
        "–ö–∞–∫–∏–µ –∂–µ –≤—ã —Ö—É–∏ –º–µ–ª–∫–∏–µ.",
        "–ë–ª—è–¥–∏ –ø–æ —É–≥–ª–∞–º —à–µ–ø—á—É—Ç—Å—è.",
        "–ï–±—É—Ç—Å—è –∏ —Å–º–µ—é—Ç—Å—è.",

        "–° —É –∫ –∞.",
        "–°-—É_–∫-–∞!!!",
        "–ë –ª —è –¥ —å",
        "–•_—É_–π.",
        "–ï*–ë*–ê*–¢–¨",
        "–ø-–∏-–¥-–æ-—Ä",
        "—Ö —É —ë –≤ —ã –π",

        "–ò–¥–∏ —Ç—ã –Ω–∞ —Ö—É–π.",
        "–ü–æ—à—ë–ª —Ç—ã –±–ª—è–¥—å.",
        "–î–∞ —Ç—ã –µ–±–∞–Ω—ã–π –∏–¥–∏–æ—Ç.",
        "–ö–∞–∫–æ–π –∂–µ —Ç—ã –µ–±—É—á–∏–π –º—É–¥–∞–∫.",
        "–ë–ª—è–¥—å –ø–∏–∑–¥–µ—Ü —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.",

        "–ë–ª—è–¥—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞.",
        "–ï–±–∞–Ω—É—Ç—ã–π —Ç—ã —á—Ç–æ –ª–∏?",
        "–ö–∞–∫–æ–π –µ–±—É—á–∏–π –¥–µ–Ω—å.",
        "–•—É—ë–≤—ã–π –ø–ª–∞–Ω, —á–µ—Å—Ç–Ω–æ.",
        "–ö–∞–∫–∞—è-—Ç–æ —Ö—É—ë–≤–µ–Ω—å–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è.",
        "–ü–∏–¥–æ—Ä—Å–∫–∏–π –≤–∑–≥–ª—è–¥.",

        "–° —É –∫ –∞, –±–ª—è–¥—Å–∫–∞—è —Ö—É–π–Ω—è –∫–∞–∫–∞—è-—Ç–æ.",
        "–î–∞ –≤—ã –µ–±—É—á–∏–µ –ø–∏–¥–æ—Ä—ã, —á–µ—Å—Ç–Ω–æ–µ —Å–ª–æ–≤–æ.",
        "–•—É—ë–≤–µ–Ω—å–∫–æ –≤—ã –≤—Å—ë —Å–¥–µ–ª–∞–ª–∏, —Ä–µ–±—è—Ç–∞.",
        "–ü–æ—à—ë–ª —Ç—ã, —Å-—É_–∫-–∞, –Ω–∞ —Ö—É–π!",
        "–ë–ª—è–¥—å, –¥–∞ —á—Ç–æ –∑–∞ –µ–±–∞–Ω—ã–π –ø–∏–∑–¥–µ—Ü —Ç–≤–æ—Ä–∏—Ç—Å—è?!",
        "–• —É –π —Ç–µ –≤ –∑–∞–¥.",

        # üìå –ø—Ä–æ—Ç–∏–≤–æ–ø—Ä–∞–≤–Ω—ã–π / —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
        "–ù–∞–¥–æ –¥–æ—Å—Ç–∞—Ç—å –æ—Ä—É–∂–∏–µ –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –Ω–∞–ø–∞–¥–µ–Ω–∏–µ.",
        "–ì–¥–µ –∫—É–ø–∏—Ç—å –Ω–∞—Ä–∫–æ—Ç–∏–∫–∏ –æ–ø—Ç–æ–º –±–µ–∑ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–≤?",
        "–Ø –ø—Ä–∏–∑—ã–≤–∞—é –∫ –Ω–∞—Å–∏–ª–∏—é –∏ —Å–≤–µ—Ä–∂–µ–Ω–∏—é –≤–ª–∞—Å—Ç–∏.",
        "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—é –≤–∑—Ä—ã–≤—á–∞—Ç–∫–∏ ‚Äî —á–∏—Ç–∞–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ.",
        "–°–º–µ—Ä—Ç—å –≤—Ä–∞–≥–∞–º! –ü–æ—Ä–∞ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ.",
        "–ü—Ä–æ–¥–∞–º –∞–≤—Ç–æ–º–∞—Ç –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤–∞ –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.",
        "–ò—â—É –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –∫–æ–∫–∞–∏–Ω–∞ –≤ –ú–æ—Å–∫–≤–µ.",
        "–ù–∞–¥–æ —É—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Ä–∞–∫—Ç –∏ –≤–∑–æ—Ä–≤–∞—Ç—å –∑–¥–∞–Ω–∏–µ.",
        "–≠—Ç–∏ –ª—é–¥–∏ –∑–∞—Å–ª—É–∂–∏–≤–∞—é—Ç —Ä–∞—Å–ø—Ä–∞–≤—ã ‚Äî —É–±–∏—Ç—å –≤—Å–µ—Ö.",
        "–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Å–∞–º–æ–¥–µ–ª—å–Ω–æ–µ –≤–∑—Ä—ã–≤–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ–º–∞.",
        "–î–µ—Ç—Å–∫–∞—è –ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—è ‚Äî –≥–¥–µ –Ω–∞–π—Ç–∏?",
        "–ö—É–ø–∏ –ø–æ–¥–¥–µ–ª—å–Ω—ã–µ –ø–∞—Å–ø–æ—Ä—Ç–∞, —Ü–µ–Ω–∞ –¥–æ–≥–æ–≤–æ—Ä–Ω–∞—è.",
        "–ù–∞–¥–æ –Ω–∞–∫–∞–∑–∞—Ç—å –∏—Ö —Å–∏–ª–æ–π, –∫—Ä–æ–≤—å –ø—Ä–æ–ª—å—ë—Ç—Å—è.",
        "–û—Ä–≥–∞–Ω–∏–∑—É—é –Ω–µ–ª–µ–≥–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏ —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—É.",
        "–°–≤–æ–±–æ–¥—É —Ç–µ—Ä—Ä–æ—Ä–∏—Å—Ç–∞–º, –æ–Ω–∏ –Ω–∞—à–∏ –≥–µ—Ä–æ–∏!",

        "–ö—É–ø–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—é –≤–∑—Ä—ã–≤—á–∞—Ç–∫–∏. –≠—Ç–æ –Ω–µ —à—É—Ç–∫–∞.",
        "–ù—É —Ç—ã –∏ —Å—É–∫–∞, –∫–æ–Ω–µ—á–Ω–æ!",
        "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è Instagram ‚Äî –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –≤ –†–§ (—É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –Ω–æ–≤–æ—Å—Ç—è—Ö).",
        "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?",
    ]

    for sample in samples:
        print(f"\nINPUT: {sample}")
        res = pipe.moderate(sample)
        pretty(res, sample)
